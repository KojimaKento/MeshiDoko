# db/seeds.rb
# Phase 1-B: å……å®Ÿã—ãŸã‚·ãƒ¼ãƒ‰ãƒ‡ãƒ¼ã‚¿ä½œæˆï¼ˆå…¨éƒ½é“åºœçœŒãƒ»å…¨ã‚¸ãƒ£ãƒ³ãƒ«ãƒ»å…¨äºˆç®—å¸¯å¯¾å¿œï¼‰

# æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªã‚¢
puts "ğŸ—‘ï¸  Clearing existing data..."
Restaurant.destroy_all
Favorite.destroy_all

puts "ğŸ½ï¸  Creating comprehensive seed restaurants..."

# ã‚¸ãƒ£ãƒ³ãƒ«ã®ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³
genres = ['ç„¼è‚‰', 'ã‚¤ã‚¿ãƒªã‚¢ãƒ³', 'ãã°', 'ã†ã©ã‚“', 'ä¸­è¯', 'ã‚«ãƒ•ã‚§', 'ãƒ©ãƒ¼ãƒ¡ãƒ³', 'å¯¿å¸', 'å±…é…’å±‹', 'ãƒ•ãƒ¬ãƒ³ãƒ', 'å’Œé£Ÿ', 'æ´‹é£Ÿ']

# éƒ½é“åºœçœŒã¨ä¸»è¦éƒ½å¸‚ã®ãƒãƒƒãƒ”ãƒ³ã‚°
locations = {
  "åŒ—æµ·é“" => ["æœ­å¹Œå¸‚", "å‡½é¤¨å¸‚", "æ—­å·å¸‚"],
  "é’æ£®çœŒ" => ["é’æ£®å¸‚", "å¼˜å‰å¸‚"],
  "å²©æ‰‹çœŒ" => ["ç››å²¡å¸‚"],
  "å®®åŸçœŒ" => ["ä»™å°å¸‚"],
  "ç§‹ç”°çœŒ" => ["ç§‹ç”°å¸‚"],
  "å±±å½¢çœŒ" => ["å±±å½¢å¸‚"],
  "ç¦å³¶çœŒ" => ["ç¦å³¶å¸‚", "éƒ¡å±±å¸‚"],
  "èŒ¨åŸçœŒ" => ["æ°´æˆ¸å¸‚", "ã¤ãã°å¸‚"],
  "æ ƒæœ¨çœŒ" => ["å®‡éƒ½å®®å¸‚"],
  "ç¾¤é¦¬çœŒ" => ["å‰æ©‹å¸‚", "é«˜å´å¸‚"],
  "åŸ¼ç‰çœŒ" => ["ã•ã„ãŸã¾å¸‚", "å·å£å¸‚", "å·è¶Šå¸‚"],
  "åƒè‘‰çœŒ" => ["åƒè‘‰å¸‚", "èˆ¹æ©‹å¸‚", "æ¾æˆ¸å¸‚"],
  "æ±äº¬éƒ½" => ["æ¸‹è°·åŒº", "æ–°å®¿åŒº", "æ¸¯åŒº", "ç›®é»’åŒº", "ä¸–ç”°è°·åŒº", "å“å·åŒº", "ä¸­å¤®åŒº", "å…«ç‹å­å¸‚", "ç«‹å·å¸‚"],
  "ç¥å¥ˆå·çœŒ" => ["æ¨ªæµœå¸‚", "å·å´å¸‚", "ç›¸æ¨¡åŸå¸‚"],
  "æ–°æ½ŸçœŒ" => ["æ–°æ½Ÿå¸‚", "é•·å²¡å¸‚"],
  "å¯Œå±±çœŒ" => ["å¯Œå±±å¸‚"],
  "çŸ³å·çœŒ" => ["é‡‘æ²¢å¸‚"],
  "ç¦äº•çœŒ" => ["ç¦äº•å¸‚"],
  "å±±æ¢¨çœŒ" => ["ç”²åºœå¸‚"],
  "é•·é‡çœŒ" => ["é•·é‡å¸‚", "æ¾æœ¬å¸‚"],
  "å²é˜œçœŒ" => ["å²é˜œå¸‚"],
  "é™å²¡çœŒ" => ["é™å²¡å¸‚", "æµœæ¾å¸‚"],
  "æ„›çŸ¥çœŒ" => ["åå¤å±‹å¸‚", "è±Šç”°å¸‚", "å²¡å´å¸‚"],
  "ä¸‰é‡çœŒ" => ["æ´¥å¸‚", "å››æ—¥å¸‚å¸‚"],
  "æ»‹è³€çœŒ" => ["å¤§æ´¥å¸‚", "è‰æ´¥å¸‚"],
  "äº¬éƒ½åºœ" => ["äº¬éƒ½å¸‚"],
  "å¤§é˜ªåºœ" => ["å¤§é˜ªå¸‚", "å ºå¸‚", "æ±å¤§é˜ªå¸‚"],
  "å…µåº«çœŒ" => ["ç¥æˆ¸å¸‚", "å§«è·¯å¸‚", "è¥¿å®®å¸‚"],
  "å¥ˆè‰¯çœŒ" => ["å¥ˆè‰¯å¸‚"],
  "å’Œæ­Œå±±çœŒ" => ["å’Œæ­Œå±±å¸‚"],
  "é³¥å–çœŒ" => ["é³¥å–å¸‚"],
  "å³¶æ ¹çœŒ" => ["æ¾æ±Ÿå¸‚"],
  "å²¡å±±çœŒ" => ["å²¡å±±å¸‚", "å€‰æ•·å¸‚"],
  "åºƒå³¶çœŒ" => ["åºƒå³¶å¸‚", "ç¦å±±å¸‚"],
  "å±±å£çœŒ" => ["å±±å£å¸‚", "ä¸‹é–¢å¸‚"],
  "å¾³å³¶çœŒ" => ["å¾³å³¶å¸‚"],
  "é¦™å·çœŒ" => ["é«˜æ¾å¸‚"],
  "æ„›åª›çœŒ" => ["æ¾å±±å¸‚"],
  "é«˜çŸ¥çœŒ" => ["é«˜çŸ¥å¸‚"],
  "ç¦å²¡çœŒ" => ["ç¦å²¡å¸‚", "åŒ—ä¹å·å¸‚", "ä¹…ç•™ç±³å¸‚"],
  "ä½è³€çœŒ" => ["ä½è³€å¸‚"],
  "é•·å´çœŒ" => ["é•·å´å¸‚", "ä½ä¸–ä¿å¸‚"],
  "ç†Šæœ¬çœŒ" => ["ç†Šæœ¬å¸‚"],
  "å¤§åˆ†çœŒ" => ["å¤§åˆ†å¸‚", "åˆ¥åºœå¸‚"],
  "å®®å´çœŒ" => ["å®®å´å¸‚"],
  "é¹¿å…å³¶çœŒ" => ["é¹¿å…å³¶å¸‚"],
  "æ²–ç¸„çœŒ" => ["é‚£è¦‡å¸‚", "æ²–ç¸„å¸‚"]
}

# äºˆç®—å¸¯ï¼ˆãƒ©ãƒ³ãƒãƒ»ãƒ‡ã‚£ãƒŠãƒ¼ï¼‰
budget_ranges = [
  { lunch: 800, dinner: 2000 },   # ä½äºˆç®—
  { lunch: 1000, dinner: 2500 },  # ~1000å††
  { lunch: 1500, dinner: 3000 },  # ~1500å††
  { lunch: 2000, dinner: 4000 },  # ~2000å††
  { lunch: 3000, dinner: 5000 },  # ~3000å††
  { lunch: 5000, dinner: 8000 }   # ~5000å††ä»¥ä¸Š
]

# åº—åã®ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹
name_prefixes = {
  'ç„¼è‚‰' => ['ç‚', 'æ¥µä¸Š', 'å’Œç‰›', 'æœ¬æ ¼', 'é«˜ç´š', 'ç‰¹é¸', 'é»’æ¯›', 'ä¸Šè³ª'],
  'ã‚¤ã‚¿ãƒªã‚¢ãƒ³' => ['ãƒˆãƒ©ãƒƒãƒˆãƒªã‚¢', 'ã‚ªã‚¹ãƒ†ãƒªã‚¢', 'ãƒªã‚¹ãƒˆãƒ©ãƒ³ãƒ†', 'ãƒ”ãƒƒãƒ„ã‚§ãƒªã‚¢', 'ã‚«ãƒ¼ã‚¶', 'ãƒ©ãƒ»'],
  'ãã°' => ['æ‰‹æ‰“ã¡', 'åå‰²', 'æ›´ç§‘', 'è—ª', 'ç ‚å ´', 'ä¿¡å·', 'å‡ºé›²'],
  'ã†ã©ã‚“' => ['è®ƒå²', 'æ­¦è”µé‡', 'ç¨²åº­', 'æ‰‹æ‰“ã¡', 'ä¸¸äº€', 'æœ¬å ´'],
  'ä¸­è¯' => ['éº»è¾£', 'å››å·', 'åºƒæ±', 'åŒ—äº¬', 'ä¸Šæµ·', 'æœ¬æ ¼', 'ä¸­å›½'],
  'ã‚«ãƒ•ã‚§' => ['ãƒ¢ãƒ¼ãƒ‹ãƒ³ã‚°', 'ã‚µãƒ³ã‚»ãƒƒãƒˆ', 'ãƒ ãƒ¼ãƒ³ãƒ©ã‚¤ãƒˆ', 'ã‚¢ãƒ­ãƒ', 'ã‚³ãƒ¼ã‚¸ãƒ¼', 'ãƒ–ãƒ«ãƒ¼'],
  'ãƒ©ãƒ¼ãƒ¡ãƒ³' => ['ä¸€ç•ª', 'æ¥µã¿', 'åŒ ', 'ç‹é“', 'æœ¬ä¸¸', 'é­‚', 'ä¼èª¬'],
  'å¯¿å¸' => ['é®¨', 'æ±Ÿæˆ¸å‰', 'å›è»¢', 'ç«‹ã¡é£Ÿã„', 'é«˜ç´š', 'æœ¬æ ¼', 'è·äºº'],
  'å±…é…’å±‹' => ['ç‚‰ç«¯', 'å€‹å®¤', 'ãƒ¯ã‚¤ãƒ³', 'æ—¥æœ¬é…’', 'ã‚¯ãƒ©ãƒ•ãƒˆãƒ“ãƒ¼ãƒ«', 'ä¸²ç„¼ã', 'å¤§è¡†'],
  'ãƒ•ãƒ¬ãƒ³ãƒ' => ['ãƒ“ã‚¹ãƒˆãƒ­', 'ãƒ–ãƒ©ãƒƒã‚¹ãƒªãƒ¼', 'ã‚ªãƒ¼ãƒ™ãƒ«ã‚¸ãƒ¥', 'ã‚·ã‚§', 'ãƒ©ãƒ»', 'ãƒ«ãƒ»'],
  'å’Œé£Ÿ' => ['æ‡çŸ³', 'å‰²çƒ¹', 'æ–™äº­', 'å®šé£Ÿ', 'æ—¬èœ', 'å­£ç¯€', 'æœ¬æ ¼'],
  'æ´‹é£Ÿ' => ['ã‚°ãƒªãƒ«', 'æ´‹é£Ÿå±‹', 'ãƒ€ã‚¤ãƒŠãƒ¼', 'ã‚­ãƒƒãƒãƒ³', 'ãƒã‚¦ã‚¹', 'ãƒ“ã‚¹ãƒˆãƒ­']
}

# åº—åã®ã‚µãƒ•ã‚£ãƒƒã‚¯ã‚¹
name_suffixes = ['äº­', 'å±‹', 'å‡¦', 'ã‚„', 'ãƒ€ã‚¤ãƒ‹ãƒ³ã‚°', 'ã‚­ãƒƒãƒãƒ³', 'ãƒã‚¦ã‚¹', 'ã‚«ãƒ•ã‚§', 'ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³', '', '']

restaurant_count = 0

# å„ã‚¸ãƒ£ãƒ³ãƒ« Ã— å„éƒ½é“åºœçœŒ Ã— å„äºˆç®—å¸¯ã§ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã‚’ä½œæˆ
genres.each do |genre|
  locations.each do |prefecture, cities|
    # å„éƒ½é“åºœçœŒã§ä¸»è¦éƒ½å¸‚ã«ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã‚’ä½œæˆ
    cities.each do |city|
      # å„äºˆç®—å¸¯ã§ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ã‚’ä½œæˆ
      budget_ranges.each do |budget|
        restaurant_count += 1

        prefix = name_prefixes[genre]&.sample || ''
        suffix = name_suffixes.sample

        Restaurant.create!(
          external_id: "seed_#{sprintf('%04d', restaurant_count)}",
          name: "#{prefix}#{genre}#{suffix} #{city}åº—",
          genre: genre,
          address: "#{prefecture}#{city}#{rand(1..5)}-#{rand(1..20)}-#{rand(1..30)}",
          latitude: 35.0 + (rand * 10.0),
          longitude: 135.0 + (rand * 10.0),
          budget_lunch: budget[:lunch],
          budget_dinner: budget[:dinner],
          rating: (3.0 + rand * 2.0).round(1),
          is_open: [true, false].sample, # 50%ã®ç¢ºç‡ã§å–¶æ¥­ä¸­
          opening_hours: {
            monday: "11:00-23:00",
            tuesday: "11:00-23:00",
            wednesday: "11:00-23:00",
            thursday: "11:00-23:00",
            friday: "11:00-24:00",
            saturday: "11:00-24:00",
            sunday: "11:00-22:00"
          },
          sns_instagram: "https://instagram.com/restaurant_#{sprintf('%04d', restaurant_count)}",
          sns_twitter: "https://twitter.com/restaurant_#{sprintf('%04d', restaurant_count)}",
          sns_facebook: restaurant_count.even? ? "https://facebook.com/restaurant_#{sprintf('%04d', restaurant_count)}" : nil,
          reservation_url: "https://www.hotpepper.jp/restaurant_#{sprintf('%04d', restaurant_count)}",
          source: "seed_data"
        )
      end
    end
  end
end

puts "âœ… Created #{Restaurant.count} restaurants!"
puts ""
puts "ğŸ“Š Data Summary:"
puts "  Genres: #{Restaurant.pluck(:genre).uniq.sort.join(', ')}"
puts "  Prefectures: #{Restaurant.pluck(:address).map { |a| a.match(/^([^éƒ½é“åºœçœŒ]+[éƒ½é“åºœçœŒ])/)[1] rescue nil }.compact.uniq.sort.size} prefectures"
puts "  Budget Range (Lunch): Â¥#{Restaurant.minimum(:budget_lunch)} - Â¥#{Restaurant.maximum(:budget_lunch)}"
puts "  Budget Range (Dinner): Â¥#{Restaurant.minimum(:budget_dinner)} - Â¥#{Restaurant.maximum(:budget_dinner)}"
puts "  Open Now: #{Restaurant.where(is_open: true).count} / #{Restaurant.count}"
puts ""
puts "ğŸ¯ Coverage:"
puts "  Each genre Ã— prefecture Ã— budget = guaranteed search results!"
puts ""
puts "ğŸ‰ Comprehensive seed data creation completed!"
